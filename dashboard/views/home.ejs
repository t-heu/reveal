<% if (!user) { %>
  <%- include('header') %>
<% } else { %>
  <%- include('headerLogged', {user, active_side: '1'}) %>
<% } %>

<% if(error && error != "") { %>
  <div class="alert alert-danger alert-dismissible fade show" role="alert">
    <strong>Error</strong>  <%= error %>
    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
<% } %>

<% if(success && success != "") { %>
  <div class="alert alert-success alert-dismissible fade show" role="alert">
    <strong>Success</strong>  <%= success %>
    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
<% } %>

<% if (!user) { %>
  <div class="container mt-5" style="display: flex;
  align-items: center;
  justify-content: center;">
    <form class="login-or-create" action="/session" method="POST">
      <h2>Log In</h2>
      <div class="form-group">
        <label for="exampleInputEmail1">Email address</label>
        <input type="email" name="email" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" placeholder="Enter email">
        <small id="emailHelp" class="form-text">The account has to be confirmed by the admin.</small>
      </div>
      <div class="form-group">
        <label for="exampleInputPassword1">Password</label>
        <input type="password" class="form-control" id="exampleInputPassword1" name="password" placeholder="Password">
      </div>

      <button type="submit" class="btn login btn-primary loginBtn--signup" style="margin-top: 0; background-color: #fc9636; border-color: #fc9636">LOG IN</button>
    </form>
  </div>
<% } else { %>
  <div class="container">
    <div class="statistics-sep-box">
      <div class="box">
        <h2>Statistics</h2>

        <div style="display: flex; justify-content: space-between;">
          <div style="width: 300px">
            <div class="progress">
              <div class="progress-bar bg-success" role="progressbar" style="width: <%= data.statistics.a %>%" aria-valuenow="<%= data.statistics.a %>" aria-valuemin="0" aria-valuemax="100"></div>
            </div>
            <div class="progress">
              <div class="progress-bar bg-primary" role="progressbar" style='width: <%= data.statistics.b %>%' aria-valuenow="<%= data.statistics.b %>" aria-valuemin="0" aria-valuemax="100"></div>
            </div>
            <div class="progress">
              <div class="progress-bar bg-warning" role="progressbar" style='width: <%= data.statistics.c %>%' aria-valuenow="<%= data.statistics.c %>" aria-valuemin="0" aria-valuemax="100"></div>
            </div>
            <div class="progress">
              <div class="progress-bar bg-danger" role="progressbar" style='width: <%= data.statistics.d %>%' aria-valuenow="<%= data.statistics.d %>" aria-valuemin="0" aria-valuemax="100"></div>
            </div>
          </div>
          
          <div>
            <div style="display: flex; color: aliceblue;">
              <div class="bg-success squad"></div>
              <p><%= data.statistics.a %>%</p>
            </div>
            <div style="display: flex; color: aliceblue;">
              <div class="bg-primary squad"></div>
              <p><%= data.statistics.b %>%</p>
            </div>
            <div style="display: flex; color: aliceblue;">
              <div class="bg-warning squad"></div>
              <p><%= data.statistics.c %>%</p>
            </div>
            <div style="display: flex; color: aliceblue;">
              <div class="bg-danger squad"></div>
              <p><%= data.statistics.d %>%</p>
            </div>
          </div>
        </div>
      </div>
  
      <div class="box">
        <h2>Devices</h2>

        <table class="table table-sm table-dark">
          <thead>
            <tr>
              <th scope="col">#</th>
              <th scope="col">First</th>
              <th scope="col">Last</th>
              <th scope="col">Handle</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th scope="row">1</th>
              <td>Mark</td>
              <td>Otto</td>
              <td>@mdo</td>
            </tr>
            <tr>
              <th scope="row">2</th>
              <td>Jacob</td>
              <td>Thornton</td>
              <td>@fat</td>
            </tr>
            <tr>
              <th scope="row">3</th>
              <td>Larry the Bird</td>
              <td>Larry the Bird</td>
              <td>@twitter</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <section class="box mt-4" style="overflow-x: auto;">
      <div class="header-table">
        <h1>Recent events</h1>
  
        <div class="change">
          <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-funnel" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" d="M1.5 1.5A.5.5 0 0 1 2 1h12a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.128.334L10 8.692V13.5a.5.5 0 0 1-.342.474l-3 1A.5.5 0 0 1 6 14.5V8.692L1.628 3.834A.5.5 0 0 1 1.5 3.5v-2zm1 .5v1.308l4.372 4.858A.5.5 0 0 1 7 8.5v5.306l2-.666V8.5a.5.5 0 0 1 .128-.334L13.5 3.308V2h-11z"/>
          </svg>
          <p>Filter</p>
        </div>
      </div>
  
      <table class="table table-striped table-dark">
        <thead>
          <tr>
            <th scope="col">Name</th>
            <th scope="col">Email</th>
            <th scope="col">Password</th>
            <th scope="col">Email Verified</th>
            <th scope="col">Photo</th>
            <th scope="col">Created At</th>
          </tr>
        </thead>
  
        <tbody>
          <% data.usersData.map(r => { %>
            <tr>
              <td><%= r.name %></td>
              <td><%= r.email %></td>
              <td><%= r.password %></td>
              <td><%= r.emailVerified %></td>
              <td><%= r.photo %></td>
              <td><%= r.createdAt %></td>
            </tr>
          <%  }) %>
        </tbody>
      </table>
    </section>
  </div>
<% } %>

<%- include('footer') %>